package torneo;

import javax.swing.JOptionPane;

public class PeleadorConTecnica extends Peleador{

	private TecnicaEspecial tecnica;

	//----------------------------Constructor----------------------------
	public PeleadorConTecnica(String nombre, double puntosVida, double puntosVidaMax, double danoXsegundo, boolean tieneTecnicaEspecial,
			boolean puedeTransformarse, TecnicaEspecial tecnica) {
		super(nombre, puntosVida, puntosVidaMax, danoXsegundo, tieneTecnicaEspecial, puedeTransformarse);
		this.tecnica = tecnica;
	}
	public PeleadorConTecnica(String nombre, double puntosVida, double puntosVidaMax, double danoXsegundo, boolean tieneTecnicaEspecial,
			boolean puedeTransformarse) {
		super(nombre, puntosVida, puntosVidaMax, danoXsegundo, tieneTecnicaEspecial, puedeTransformarse);
		this.tecnica = new TecnicaEspecial("Bola de EnergÃ­a", 100);
	}
	
	//----------------------------MÃ©todos----------------------------
	
	//Utiliza su tÃ©cnica especial en el contricante
	public void usarTecnica(Peleador adversario) {
		//El adversario es daÃ±ado por la tÃ©cnica
		adversario.setPuntosVida(adversario.getPuntosVida() - this.getTecnica().getDano());
	}
	
	//SOBRESCRIBE la el mÃ©todo pelear pero con tÃ©cnica especial
	public Peleador[] pelear(Peleador contrincante) {
		
		boolean tecnica1 = false;
		boolean tecnica2 = false;
		boolean transformacionContrincante = false;
		
		
		//Array para guardar al ganador(pos 0) y al perdedor(pos 1)
		Peleador[] ganador_perdedor = new Peleador[2];
		String historialPelea = this.getNombre() + " VS " + contrincante.getNombre() + "\n";
		
		//Pelean hasta que uno se quede sin vida
		while(this.getPuntosVida() > 0 && contrincante.getPuntosVida() > 0) {
			
			//Peleador 1 golpea al Peleador 2
			if(this.getPuntosVida() > 0) {				
				contrincante.setPuntosVida(contrincante.getPuntosVida() - this.getDanoXsegundo());
				if(contrincante.getPuntosVida() < 0) contrincante.setPuntosVida(0);
				historialPelea += this.getNombre() + " golpea"+ " (-" + this.getDanoXsegundo() + " HP) "+ " a " 
						+ contrincante.getNombre() + " (" + contrincante.getPuntosVida() + "HP)\n";
			}
			
			//Peleador 2 golpea al Peleador 1
			if(contrincante.getPuntosVida() > 0) {				
				this.setPuntosVida(this.getPuntosVida() - contrincante.getDanoXsegundo());
				historialPelea += contrincante.getNombre() + " golpea"+ " (-" + contrincante.getDanoXsegundo() + " HP) "+ " a " 
						+ this.getNombre() + " (" + this.getPuntosVida() + "HP)\n";
			}
			
			//Si el contrincante puede transformarse y tiene menos de 800HP, se transforma
			if(contrincante.getPuntosVida() <= 800 && contrincante.isPuedeTransformarse() && !transformacionContrincante) {
				contrincante.transformarse();
				transformacionContrincante = true;
				historialPelea += "â¬†ï¸â¬†ï¸â¬†ï¸â¬†ï¸" + contrincante.getNombre() + " se transforma en " 
				+ contrincante.getTransformacion().getNombre() + "â¬†ï¸â¬†ï¸â¬†ï¸â¬†ï¸\n";
			}
			
			//Si tienen menos del 500HP, ejecutan sus tÃ©cnicas secretas
			if(this.getPuntosVida() <= 500 && this.getPuntosVida() > 0 && !tecnica1) {
				this.usarTecnica(contrincante);
				tecnica1 = true;
				historialPelea += "ðŸ’£ðŸ’£ðŸ’£ðŸ’£" + this.getNombre() + " utiliza \"" + this.getTecnica().getNombre() + "\" sobre " + contrincante.getNombre() 
				+ " (-" + this.getTecnica().getDano() + "HP)" + "ðŸ’£ðŸ’£ðŸ’£ðŸ’£\n";
			}
			if(contrincante.getPuntosVida() <= 500 && contrincante.getPuntosVida() > 0 && contrincante.isTieneTecnicaEspecial() && !tecnica2) {
				contrincante.usarTecnica(this);
				tecnica2 = true;
				historialPelea += "ðŸ’£ðŸ’£ðŸ’£ðŸ’£" + contrincante.getNombre() + " utiliza \"" + contrincante.getTecnica().getNombre() + "\" sobre " + this.getNombre() 
				+ " (-" + contrincante.getTecnica().getDano() + "HP)" + "ðŸ’£ðŸ’£ðŸ’£ðŸ’£\n";
			}
		}
		
		//Vuelven a su estado base
		if(contrincante.isPuedeTransformarse() && transformacionContrincante) {
			contrincante.volverEstadoBase();
		}
		
		if(this.getPuntosVida() <= 0) {
			//Gana el contrincante
			ganador_perdedor[0] = contrincante;
			ganador_perdedor[1] = this;
			historialPelea += "â˜ ï¸â˜ ï¸â˜ ï¸" + this.getNombre() + " ya no es capaz de seguir peleandoâ˜ ï¸â˜ ï¸â˜ ï¸"
					+ "\n\n ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸  " + contrincante.getNombre() + " es el GANADOR  ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸";
		}else {
			//Gana el peleador actual
			ganador_perdedor[0] = this;
			ganador_perdedor[1] = contrincante;	
			historialPelea += "â˜ ï¸â˜ ï¸â˜ ï¸" + contrincante.getNombre() + " ya no es capaz de seguir peleandoâ˜ ï¸â˜ ï¸â˜ ï¸"
					+ "\n\n ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸  " + this.getNombre() + " es el GANADOR  ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸ðŸŽ–ï¸";
		}
		
		JOptionPane.showMessageDialog(null, historialPelea);
		return ganador_perdedor;
		
	}
	
	//Vuelve a su estado base desde la transformaciÃ³n
	public void volverEstadoBase() {}
	
	public TecnicaEspecial getTecnica() {
		return tecnica;
	}
	
	public void setTecnica(TecnicaEspecial tecnica) {
		this.tecnica = tecnica;
	}
	
	
}
