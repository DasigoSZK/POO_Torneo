package torneo;

import javax.swing.JOptionPane;

public class Androide extends Peleador{
	private TecnicaEspecial tecnica;
	private Transformacion transformacion;
	
	//----------------------------Constructor----------------------------
	public Androide(String nombre, double puntosVida, double danoXsegundo, boolean tieneTecnicaEspecial, boolean puedeTransformarse, 
					TecnicaEspecial tecnica, Transformacion transformacion) {
		
		super(nombre, puntosVida, danoXsegundo, tieneTecnicaEspecial, puedeTransformarse);
		this.tecnica = tecnica;
		this.transformacion = transformacion;
	}
	
	public Androide(String nombre, double puntosVida, double danoXsegundo, boolean tieneTecnicaEspecial, boolean puedeTransformarse, 
			TecnicaEspecial tecnica) {

		super(nombre, puntosVida, danoXsegundo, tieneTecnicaEspecial, puedeTransformarse);
		this.tecnica = tecnica;
		this.transformacion = new Transformacion("Poder Máximo", 5, 10);
	}
	
	public Androide(String nombre, double puntosVida, double danoXsegundo, boolean tieneTecnicaEspecial, boolean puedeTransformarse) {

		super(nombre, puntosVida, danoXsegundo, tieneTecnicaEspecial, puedeTransformarse);
		this.tecnica = new TecnicaEspecial("Bola de Energía", 100);
		this.transformacion = new Transformacion("Poder Máximo", 5, 10);
	}

	
	//----------------------------Métodos----------------------------
	
	//Se transforma en Cell Perfecto / Poder Máximo
	public void transformarse() {
		//Multiplica la vida del peleador
		this.setPuntosVida(this.getPuntosVida() * this.getTransformacion().getVidaExtra());
		//Multiplica el daño por segundo del peleador
		this.setDanoXsegundo(this.getDanoXsegundo() * this.getTransformacion().getDanoExtra());
	}
	
	//Utiliza su técnica especial en el contricante
	public void usarTecnica(Peleador adversario) {
			//El adversario es dañado por la técnica
			adversario.setPuntosVida(adversario.getPuntosVida() - this.getTecnica().getDano());
	}
	
	//SOBRESCRIBE la el método pelear pero con TÉCNICA y TRANSFORMACION
	public Peleador[] pelear(Peleador contrincante) {
		
		//Array para guardar al ganador(pos 0) y al perdedor(pos 1)
		Peleador[] ganador_perdedor = new Peleador[2];
		String historialPelea = this.getNombre() + " VS " + contrincante.getNombre() + "\n";
		
		//Pelean hasta que uno se quede sin vida
		while(this.getPuntosVida() > 0 && contrincante.getPuntosVida() > 0) {
			
			//Peleador 1 golpea al Peleador 2
			contrincante.setPuntosVida(contrincante.getPuntosVida() - this.getDanoXsegundo());
			historialPelea += this.getNombre() + " golpea a " + contrincante.getNombre() + " (-" + this.getDanoXsegundo() + " HP)\n";
			
			//Peleador 2 golpea al Peleador 1
			this.setPuntosVida(this.getPuntosVida() - contrincante.getDanoXsegundo());
			historialPelea += contrincante.getNombre() + " golpea a " + this.getNombre() + " (-" + contrincante.getDanoXsegundo() + " HP)\n";
			
			//Si tienen menos del 500HP, ejecutan sus técnicas secretas
			if(this.getPuntosVida() <= 500) {
				this.usarTecnica(contrincante);
				historialPelea += this.getNombre() + " utiliza \"" + this.getTecnica().getNombre() + "\" sobre " + contrincante.getNombre() 
				+ " (-" + this.getTecnica().getDano() + "HP)" + "\n";
			}
			if(contrincante.getPuntosVida() <= 500 && contrincante.isTieneTecnicaEspecial()) {
				contrincante.usarTecnica(this);
				historialPelea += contrincante.getNombre() + " utiliza \"" + contrincante.getTecnica().getNombre() + "\" sobre " + this.getNombre() 
				+ " (-" + contrincante.getTecnica().getDano() + "HP)" + "\n";
			}
		}
		
		if(this.getPuntosVida() <= 0) {
			//Gana el contrincante
			ganador_perdedor[0] = this;
			ganador_perdedor[1] = contrincante;
			historialPelea += this.getNombre() + " ya no es capaz de seguir peleando. \n\n " + contrincante.getNombre() + " es el GANADOR!!";
		}else {
			//Gana el peleador actual
			ganador_perdedor[0] = contrincante;
			ganador_perdedor[1] = this;	
			historialPelea += contrincante.getNombre() + " ya no es capaz de seguir peleando. \n\n " + this.getNombre() + " es el GANADOR!!";
		}
		
		JOptionPane.showMessageDialog(null, historialPelea);
		return ganador_perdedor;
		
	}
	
	
	public TecnicaEspecial getTecnica() {
		return tecnica;
	}

	public void setTecnica(TecnicaEspecial tecnica) {
		this.tecnica = tecnica;
	}

	public Transformacion getTransformacion() {
		return transformacion;
	}

	public void setTransformacion(Transformacion transformacion) {
		this.transformacion = transformacion;
	}
}
